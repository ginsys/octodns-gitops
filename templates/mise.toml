# octodns-gitops mise configuration template
# Copy this file to your dns-zones repository

[tools]
python = "3.12"

[env]
_.python.venv = { path = "pyvenv", create = true }

# Update this to change octodns-gitops version
# Use a commit hash or tag (e.g., "v0.1.0" or "abc123")
OCTODNS_GITOPS_VERSION = "main"

[tasks.setup]
description = "Install dependencies and generate Makefile"
run = """
mise trust
rm -rf {{config_root}}/pyvenv {{config_root}}/Makefile
python -m venv {{config_root}}/pyvenv
pip install --upgrade pip
pip install --no-cache-dir --force-reinstall "octodns-gitops @ git+https://github.com/ginsys/octodns-gitops@${OCTODNS_GITOPS_VERSION}"
octodns-gitops-init > Makefile
"""

[tasks.update]
description = "Update mise file to latest version"
run = """
curl https://raw.githubusercontent.com/ginsys/octodns-gitops/main/templates/mise.toml -o {{config_root}}/mise.toml
octodns-gitops-init > {{config_root}}/Makefile
"""
